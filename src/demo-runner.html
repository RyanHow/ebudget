<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
  <title>eBudget Demo Runner</title>
</head>
<body>

  <div>Some controller stuff here to control the demo</div>
  Demo Script<br>
  <textarea id="demo1script" rows=10>
  {"setup":[
  ["create-db", "Testing123"],
  ["root", "budget", {"budgetId": "${current-db-id}"}]
  ],
  "queue":[
  ["wait", 1000], 
  ["move", ".bar-buttons"], 
  ["click", ".bar-buttons"], 
  ["wait", 1000], 
  ["move", "#main-menu-home"], 
  ["click", "#main-menu-home"], 
  ["wait", 1000], 
  ["move", "#home-create-new-budget"], 
  ["click", "#home-create-new-budget"],
  ["wait", 1000], 
  ["move", "#add-budget-budget-name"], 
  ["click", "#add-budget-budget-name"],
  ["type", "#add-budget-budget-name", "My First Budget"],
  ["move", "#add-budget-create"], 
  ["click", "#add-budget-create"],
  ["wait", 5000], 
  ["loop"]
  ]}    
      </textarea><br>
  <input type="button" id="demo1run" value="Run" disabled onclick="document.querySelector('#demo1').contentWindow.postMessage({'demo' : {'command' : 'script', 'script' : document.getElementById('demo1script').value}}, 'http://localhost2:8100');">
  <input type="button" id="demo1reset" value="Reset" disabled onclick="document.querySelector('#demo1').contentWindow.postMessage({'demo' : {'command' : 'reset'}}, 'http://localhost2:8100');"><br>
  <a href="javascript:document.querySelector('#demo1').contentWindow.postMessage('sdafasf', 'http://localhost2:8100');">Test postMessage</a>
  <br>
  <iframe id="demo1" style="width:300px;height:600px;" src="http://localhost2:8100/index.html?demo=1&demo_control_url=http://localhost:8100"></iframe>

  <script>

    var ebudgetDemoPostMessageUrls =  ['http://localhost2:8100', 'https://ebudget.live'];

    function demoListener(event) {
          if (ebudgetDemoPostMessageUrls.indexOf(event.origin) >= 0) {
            if (event.data.event === 'ready' && event.data.id === '1') {
              document.getElementById('demo1run').disabled = false;
              document.getElementById('demo1reset').disabled = false;
            }
        }

    }

    window.addEventListener('message', demoListener, false);
  </script>



</body>
</html>
